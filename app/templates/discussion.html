{% extends 'base.html' %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block title %} {% if title %} {{title}} {% else %} Goup {% endif %} {% endblock %}


{% block app_content %}
<div class="container">

    <form method="POST" action="" enctype="multipart/form-data">
        {{ wtf.quick_form(post_form) }}
    </form>
    <br>


    {% for post in posts %}
        <hr>

        <a href="{{url_for('profile', username=post.author.username)}}"><img src="{{ url_for('static', filename='uploads/images/'+post.author.profile_picture)  }}" class="img-responsive" width="90" style="display:inline;"></a>&emsp;<h4 style="display:inline;"><a href="{{url_for('profile', username=post.author.username)}}">{{post.author.username}}</a> posted an update {{ moment(post.timestamp).fromNow() }}</h4><br><br>
            &emsp;<p>{{post.body}}</p>
            {% for photo in photos %}
                {% if post.id == photo.post.id %}
        <div class="container" align="center">
            <a href="{{ url_for('static', filename='uploads/images/'+ photo.filename) }}"><img class="img-responsive" src="{{ url_for('static', filename='uploads/images/'+ photo.filename) }}" width="350" ></a><br>
        </div>
                {% endif %}
            {% endfor %}
            <!--- fix: edit video title, edit each photo title, delete video --->
            {% for video in videos %}
                {% if post.id == video.post.id %}
                    <p>{{video.title}}</p>
                    <video width="1100" height="500" controls>
                        <source src="{{url_for('static', filename='uploads/videos/'+ video.filename)}}" type="video/mp4">
                    </video>
                {% endif %}
            {% endfor %}

        {% if current_user.username == post.author.username %}
            <a href="{{url_for('delete_post', id=post.id)}}"><button type="button" class="btn btn-danger">Delete</button></a>
            <a href="{{url_for('edit_post', id=post.id)}}"><button type="button" class="btn btn-primary">Edit</button></a>

        {% endif %}

    {% endfor %}



</div>
{% endblock %}